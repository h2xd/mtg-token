var e=Object.assign;import{d as t,a as n,c as o,b as s,r as a,o as r,e as i,f as l,g as c,w as u,t as p,h as d,F as h,i as m,p as k,j as f,k as y,l as g,T as v,m as b,n as w,q as _,s as S}from"./vendor.f4a7f512.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const o=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,a)=>{const r=new URL(e,o);if(self[t].moduleMap[r])return n(self[t].moduleMap[r]);const i=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){a(new Error(`Failed to import: ${e}`)),s(l)},onload(){n(self[t].moduleMap[r]),s(l)}});document.head.appendChild(l)})),self[t].moduleMap={}}}("https:/h2xd.github.io/mtg-token/assets/");const C=t({id:"life",state:()=>({remainingLife:20}),getters:{alive(){return this.remainingLife>0}},actions:{reset(){this.remainingLife=20},raise(e=1){this.remainingLife+=Math.abs(e)},reduce(e=1){this.remainingLife-=Math.abs(e),this.remainingLife<0&&(this.remainingLife=0)}}});var x,T;(T=x||(x={})).RED="red",T.BLUE="blue",T.GREEN="green",T.BLACK="black",T.WHITE="white";const L={power:1,toughness:1,isTapped:!1,hasSummoningSickness:!0,mana:[x.RED],attributes:[]};class I{constructor(t){this._summoningSickness=!0,this._options=e(e({},L),t),this._tapped=this._options.isTapped,this._summoningSickness=this._options.hasSummoningSickness,this.uuid=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))),this.reset()}get canAttack(){return!this._summoningSickness&&!this._tapped}get power(){return this._power}get toughness(){return this._toughness}get mana(){return this._options.mana}get isTapped(){return this._tapped}get hasSummoningSickness(){return this._summoningSickness}attack(){this._summoningSickness||(this._tapped=!0)}clear(){this._summoningSickness=!1,this._tapped=!1}reset(){this._power=this._options.power,this._toughness=this._options.toughness}}const $=t({id:"board",state:()=>({token:[]}),getters:{hasToken(){return this.token.length>0},tokenThatCanAttack(){return this.token.filter((e=>e.canAttack))},attackPower(){return this.tokenThatCanAttack.reduce(((e,t)=>e+t.power),0)}},actions:{addToken(e){this.token=[...this.token,e]},removeToken(e){this.token=this.token.filter((t=>t!==e))},copyToken(e){this.token=[...this.token,new I({power:e.power,toughness:e.toughness,mana:e.mana})]},attackWithAll(){this.token.forEach((e=>e.attack()))},nextTurn(){this.token.forEach((e=>e.clear()))},reset(){this.token=[]}}}),O=t({id:"player",state:()=>({life:C(),board:$(),mana:x.WHITE}),getters:{alive(){return this.life.alive}},actions:{setManaType(e){this.mana=e},reset(){this.life.reset(),this.board.reset()},nextTurn(){this.board.nextTurn()}}});function B(e){return Array.from(Array(e)).map((()=>O()))}const A=t({id:"app",state:()=>({players:B(1),countOptions:[1,2,3,4]}),getters:{count(){return this.players.length}},actions:{setPlayerCount(e){this.countOptions.includes(e)&&(this.players=B(e))},reset(){this.players.forEach((e=>e.reset()))}}});var j=n({props:{active:{type:Boolean,default:!1}}});var M={container:"_container_adb86_2",base:"_base_adb86_6",underlay:"_underlay_adb86_13",overlayed:"_overlayed_adb86_17",active:"_active_adb86_29"};(j.__cssModules={}).$style=M,j.render=function(e,t,n,i,l,c){return r(),o("div",{class:e.$style.container},[s("span",{class:[e.$style.base,e.$style.underlay]},[a(e.$slots,"default")],2),s("span",{class:[e.$style.base,e.$style.overlayed,e.active&&e.$style.active]},[a(e.$slots,"default")],2)],2)};const E={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-corner-down-left"},P=s("polyline",{points:"9 10 4 15 9 20"},null,-1),R=s("path",{d:"M20 4v7a4 4 0 0 1-4 4H4"},null,-1);const D={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-moon"},H=s("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},null,-1);function N(e){return`var(--mana-color-${e}-background)`}function F(e){return`var(--mana-color-${e}-text)`}const U={backgroundKey:"--mana-background",textKey:"--mana-text"};function K(t,n){const{backgroundKey:o,textKey:s}=e(e({},U),n);return{[o]:N(t),[s]:F(t)}}var W=n({name:"TokenCardDetail",components:{Icon:j,CornerDownLeftIcon:function(e,t){return r(),o("svg",E,[P,R])},MoonIcon:function(e,t){return r(),o("svg",D,[H])}},props:{token:Object,is:{type:String,default:"li"}},setup(e){console.log(e.token);const t=i((()=>K(e.token.mana[0])));return console.log(t),{manaStyles:t}}});const G=u("data-v-06947b57"),z=G(((e,t,n,a,i,u)=>{const h=d("CornerDownLeftIcon"),m=d("Icon"),k=d("MoonIcon");return e.token?(r(),o(l(e.is),{key:0,class:["card",e.token.isTapped&&"tapped"],style:e.manaStyles},{default:G((()=>[s("div",null,p(e.token.power)+" / "+p(e.token.toughness),1),s("div",null,[s(m,{active:e.token.isTapped},{default:G((()=>[s(h)])),_:1},8,["active"]),s(m,{active:e.token.hasSummoningSickness},{default:G((()=>[s(k)])),_:1},8,["active"])]),s("button",{onClick:t[1]||(t[1]=t=>e.$emit("death",e.token))},"Kill"),s("button",{onClick:t[2]||(t[2]=t=>e.$emit("copy",e.token))},"Clone")])),_:1},8,["class","style"])):c("",!0)}));W.render=z,W.__scopeId="data-v-06947b57";var J=n({name:"Board",components:{TokenCardDetail:W},props:{board:Object},setup:e=>({handleDeath:t=>e.board.removeToken(t),handleCopy:t=>e.board.copyToken(t)})});const Y=u("data-v-776e1f79");k("data-v-776e1f79");const q={key:0,class:"board"};f();const V=Y(((e,t,n,a,i,l)=>{const u=d("TokenCardDetail");return r(),o(h,null,[s("div",null,"AttackPower: "+p(e.board.attackPower),1),s("div",null,[e.board.hasToken?(r(),o("ol",q,[(r(!0),o(h,null,m(e.board.token,(t=>(r(),o(u,{is:"li",key:t.uuid,token:t,onDeath:e.handleDeath,onCopy:e.handleCopy},null,8,["token","onDeath","onCopy"])))),128))])):c("",!0)])],64)}));J.render=V,J.__scopeId="data-v-776e1f79";var Q={button:"_button_jkxpw_2"};const X={};var Z;(X.__cssModules={}).$style=Q,X.render=function(e,t){return r(),o("button",{class:e.$style.button},[a(e.$slots,"default")],2)},(Z||(Z={})).FLYING="flying";const ee={name:"Angel",slug:"angel",isFavorite:!1,tokenOptions:e(e({},L),{power:4,toughness:4,mana:[x.WHITE],attributes:[Z.FLYING]})},te={name:"Beast",slug:"beast",isFavorite:!1,tokenOptions:e(e({},L),{power:3,toughness:3,mana:[x.GREEN]})},ne={name:"Soldier",slug:"soldier",isFavorite:!1,tokenOptions:e(e({},L),{power:1,toughness:1,mana:[x.WHITE]})};var oe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AngelLibraryItem:ee,BeastLibraryItem:te,SoldierLibraryItem:ne});const se=t({id:"library",state:()=>({entries:[...Object.values(oe)]}),getters:{},actions:{}});const ae={},re=u("data-v-8e6e9150");k("data-v-8e6e9150");const ie={class:"headline"},le={class:"text"};f();const ce=re(((e,t)=>(r(),o("div",ie,[a(e.$slots,"icon"),s("h3",le,[a(e.$slots,"default")])]))));ae.render=ce,ae.__scopeId="data-v-8e6e9150";const ue={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-book"},pe=s("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"},null,-1),de=s("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"},null,-1);var he=n({name:"Board",components:{BookIcon:function(e,t){return r(),o("svg",ue,[pe,de])},Button:X,Headline:ae},setup:()=>({Library:se()})});const me=u("data-v-67fc2823");k("data-v-67fc2823");const ke={class:"library"},fe=y(" Library "),ye=y("Summon");f();const ge=me(((e,t,n,a,i,l)=>{const c=d("BookIcon"),u=d("Headline"),k=d("Button");return r(),o("div",ke,[s(u,null,{icon:me((()=>[s(c)])),default:me((()=>[fe])),_:1}),(r(!0),o(h,null,m(e.Library.entries,(t=>(r(),o("ul",{key:t.slug},[s("li",null,[s("div",null,p(t.name),1),s("div",null,p(t.tokenOptions.power)+"P / "+p(t.tokenOptions.toughness)+"T",1),s(k,{onClick:n=>e.$emit("summon",t)},{default:me((()=>[ye])),_:2},1032,["onClick"])])])))),128))])}));he.render=ge,he.__scopeId="data-v-67fc2823";const ve=t({id:"popup",state:()=>({portalTarget:"#popup-portal",isOpen:!1}),actions:{open(){this.isOpen=!0},close(){this.isOpen=!1}}}),be={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-x"},we=s("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),_e=s("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1);var Se=n({name:"App",components:{CloseIcon:function(e,t){return r(),o("svg",be,[we,_e])}},setup(){const e=ve();return g(e,(e=>{window.document.body.style.overflow=e.isOpen?"hidden":null})),{popupStore:e}}});const Ce={key:0,class:"popup"},xe=y("Close ");Se.render=function(e,t,n,i,l,u){const p=d("CloseIcon");return r(),o(v,{to:e.popupStore.portalTarget},[e.popupStore.isOpen?(r(),o("div",{key:0,class:"popup-underlay",onClick:t[1]||(t[1]=t=>e.popupStore.close())})):c("",!0),s(w,{name:"bounce"},{default:b((()=>[e.popupStore.isOpen?(r(),o("div",Ce,[s("button",{onClick:t[2]||(t[2]=t=>e.popupStore.close())},[xe,s(p)]),s("div",null,[a(e.$slots,"default")])])):c("",!0)])),_:1})],8,["to"])};const Te={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-plus"},Le=s("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),Ie=s("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1);const $e={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-minus"},Oe=s("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1);var Be=n({name:"LifePointsCounter",components:{Button:X,PlusIcon:function(e,t){return r(),o("svg",Te,[Le,Ie])},MinusIcon:function(e,t){return r(),o("svg",$e,[Oe])},Popup:Se},props:{player:Object},setup(e){const t=i((()=>K(e.player.mana))),n=i((()=>Object.values(x).map((t=>({mana:t,selected:e.player.mana===t,styles:K(t)})))));return{styles:t,popupStore:ve(),manaCollection:n}}});const Ae=u("data-v-40473265");k("data-v-40473265");const je=y("Reset Game");f();const Me=Ae(((e,t,n,a,i,l)=>{const c=d("PlusIcon"),u=d("MinusIcon"),k=d("Button"),f=d("Popup");return r(),o(h,null,[s("div",{class:"container",style:e.styles},[s("div",{class:"counter",onClick:t[1]||(t[1]=t=>e.popupStore.open())},p(e.player.life.remainingLife),1),s("button",{onClick:t[2]||(t[2]=t=>e.player.life.raise(1)),class:"button raise"},[s(c)]),s("button",{onClick:t[3]||(t[3]=t=>e.player.life.reduce(1)),class:"button reduce"},[s(u)])],4),s(f,null,{default:Ae((()=>[(r(!0),o(h,null,m(e.manaCollection,(t=>(r(),o("button",{key:t.mana,class:["manaButton",t.selected&&"selected"],style:t.styles,onClick:n=>e.player.setManaType(t.mana)},null,14,["onClick"])))),128)),s("div",null,[s(k,{onClick:t[4]||(t[4]=t=>e.player.reset())},{default:Ae((()=>[je])),_:1})])])),_:1})],64)}));Be.render=Me,Be.__scopeId="data-v-40473265";var Ee=n({name:"App",components:{Board:J,Button:X,Library:he,LifePointsCounter:Be},setup(){const t=A(),n=t.players[0];!function(t){t.$subscribe(((e,t)=>{window.localStorage.setItem("player1Store",JSON.stringify({board:t.board.$state,life:t.life.$state,mana:t.mana}))}));try{const n=window.localStorage.getItem("player1Store");if(n){const o=JSON.parse(n);t.$patch({board:e(e({},o.board),{token:o.board.token.map((t=>new I(e(e({},t._options),{hasSummoningSickness:t._summoningSickness,isTapped:t._tapped}))))}),life:o.life,mana:o.mana})}}catch(n){console.error(n)}}(n);const o=ve();return{player1:n,appStore:t,popupStore:o,handleAttackAll:()=>n.board.attackWithAll(),handleNextTurn:()=>n.nextTurn(),handleSummon:t=>{const o=new I(e({},t.tokenOptions));n.board.addToken(o)}}}});const Pe=y("Attack with all"),Re=y("Next Turn");Ee.render=function(e,t,n,a,i,l){const c=d("LifePointsCounter"),u=d("Board"),p=d("Button"),h=d("Library");return r(),o("div",{class:["app-container",e.popupStore.isOpen&&"scale"]},[s(c,{player:e.player1},null,8,["player"]),s(u,{board:e.player1.board},null,8,["board"]),s(p,{onClick:e.handleAttackAll},{default:b((()=>[Pe])),_:1},8,["onClick"]),s(p,{onClick:e.handleNextTurn},{default:b((()=>[Re])),_:1},8,["onClick"]),s(h,{onSummon:e.handleSummon},null,8,["onSummon"])],2)};const De=_(Ee);De.use(S()),De.mount("#app");

var e=Object.assign;import{d as t,a as n,c as o,b as s,r as a,w as r,p as i,e as l,o as c,f as u,g as p,t as d,h,F as m,i as k,j as f,k as g,T as v,l as y,m as w,n as b,q as _,s as S}from"./vendor.b0418c97.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const o=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,a)=>{const r=new URL(e,o);if(self[t].moduleMap[r])return n(self[t].moduleMap[r]);const i=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){a(new Error(`Failed to import: ${e}`)),s(l)},onload(){n(self[t].moduleMap[r]),s(l)}});document.head.appendChild(l)})),self[t].moduleMap={}}}("https:/h2xd.github.io/mtg-token/assets/");const C=t({id:"life",state:()=>({remainingLife:20}),getters:{alive(){return this.remainingLife>0}},actions:{reset(){this.remainingLife=20},raise(e=1){this.remainingLife+=Math.abs(e)},reduce(e=1){this.remainingLife-=Math.abs(e),this.remainingLife<0&&(this.remainingLife=0)}}});var x,T;(T=x||(x={})).RED="red",T.BLUE="blue",T.GREEN="green",T.BLACK="black",T.WHITE="white";const I={power:1,toughness:1,isTapped:!1,hasSummoningSickness:!0,mana:[x.RED],attributes:[]};class L{constructor(t){this._summoningSickness=!0,this._options=e(e({},I),t),this._tapped=this._options.isTapped,this._summoningSickness=this._options.hasSummoningSickness,this.uuid=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))),this.reset()}get canAttack(){return!this._summoningSickness&&!this._tapped}get power(){return this._power}get toughness(){return this._toughness}get isTapped(){return this._tapped}get hasSummoningSickness(){return this._summoningSickness}attack(){this._summoningSickness||(this._tapped=!0)}clear(){this._summoningSickness=!1,this._tapped=!1}reset(){this._power=this._options.power,this._toughness=this._options.toughness}}const O=t({id:"board",state:()=>({token:[]}),getters:{hasToken(){return this.token.length>0},tokenThatCanAttack(){return this.token.filter((e=>e.canAttack))},attackPower(){return this.tokenThatCanAttack.reduce(((e,t)=>e+t.power),0)}},actions:{addToken(e){this.token=[...this.token,e]},removeToken(e){this.token=this.token.filter((t=>t!==e))},copyToken(e){this.token=[...this.token,new L({power:e.power,toughness:e.toughness})]},attackWithAll(){this.token.forEach((e=>e.attack()))},nextTurn(){this.token.forEach((e=>e.clear()))},reset(){this.token=[]}}}),A=t({id:"player",state:()=>({life:C(),board:O(),mana:x.WHITE}),getters:{alive(){return this.life.alive}},actions:{setManaType(e){this.mana=e},reset(){this.life.reset(),this.board.reset()},nextTurn(){this.board.nextTurn()}}});function B(e){return Array.from(Array(e)).map((()=>A()))}const j=t({id:"app",state:()=>({players:B(1),countOptions:[1,2,3,4]}),getters:{count(){return this.players.length}},actions:{setPlayerCount(e){this.countOptions.includes(e)&&(this.players=B(e))},reset(){this.players.forEach((e=>e.reset()))}}});var M=n({props:{active:{type:Boolean,default:!1}}});const $=r("data-v-65fcff41");i("data-v-65fcff41");const E={class:"container"},P={class:"base underlay"};l();const D=$(((e,t,n,r,i,l)=>(c(),o("div",E,[s("span",P,[a(e.$slots,"default")]),s("span",{class:["base","overlayed",e.active&&"active"]},[a(e.$slots,"default")],2)]))));M.render=D,M.__scopeId="data-v-65fcff41";const R={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-corner-down-left"},H=s("polyline",{points:"9 10 4 15 9 20"},null,-1),N=s("path",{d:"M20 4v7a4 4 0 0 1-4 4H4"},null,-1);const U={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-moon"},F=s("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},null,-1);var K=n({name:"TokenCardDetail",components:{Icon:M,CornerDownLeftIcon:function(e,t){return c(),o("svg",R,[H,N])},MoonIcon:function(e,t){return c(),o("svg",U,[F])}},props:{token:Object,is:{type:String,default:"li"}}});const W=r("data-v-7a632aa5"),G=W(((e,t,n,a,r,i)=>{const l=h("CornerDownLeftIcon"),m=h("Icon"),k=h("MoonIcon");return e.token?(c(),o(u(e.is),{key:0,class:["card",e.token.isTapped&&"tapped"]},{default:W((()=>[s("div",null,d(e.token.power)+" / "+d(e.token.toughness),1),s("div",null,[s(m,{active:e.token.isTapped},{default:W((()=>[s(l)])),_:1},8,["active"]),s(m,{active:e.token.hasSummoningSickness},{default:W((()=>[s(k)])),_:1},8,["active"])])])),_:1},8,["class"])):p("",!0)}));K.render=G,K.__scopeId="data-v-7a632aa5";var z=n({name:"Board",components:{TokenCardDetail:K},props:{board:Object},setup:e=>({handleDeath:t=>e.board.removeToken(t),handleCopy:t=>e.board.copyToken(t)})});const J=r("data-v-776e1f79");i("data-v-776e1f79");const Y={key:0,class:"board"};l();const q=J(((e,t,n,a,r,i)=>{const l=h("TokenCardDetail");return c(),o(m,null,[s("div",null,"AttackPower: "+d(e.board.attackPower),1),s("div",null,[e.board.hasToken?(c(),o("ol",Y,[(c(!0),o(m,null,k(e.board.token,(t=>(c(),o(l,{is:"li",key:t.uuid,token:t,onDeath:e.handleDeath,onCopy:e.handleCopy},null,8,["token","onDeath","onCopy"])))),128))])):p("",!0)])],64)}));z.render=q,z.__scopeId="data-v-776e1f79";var V={button:"_button_jkxpw_2"};const Q={};var X;(Q.__cssModules={}).$style=V,Q.render=function(e,t){return c(),o("button",{class:e.$style.button},[a(e.$slots,"default")],2)},(X||(X={})).FLYING="flying";const Z={name:"Angel",slug:"angel",isFavorite:!1,tokenOptions:e(e({},I),{power:4,toughness:4,mana:[x.WHITE],attributes:[X.FLYING]})},ee={name:"Soldier",slug:"soldier",isFavorite:!1,tokenOptions:e(e({},I),{power:1,toughness:1,mana:[x.WHITE]})};var te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AngelLibraryItem:Z,SoldierLibraryItem:ee});const ne=t({id:"library",state:()=>({entries:[...Object.values(te)]}),getters:{},actions:{}});const oe={},se=r("data-v-8e6e9150");i("data-v-8e6e9150");const ae={class:"headline"},re={class:"text"};l();const ie=se(((e,t)=>(c(),o("div",ae,[a(e.$slots,"icon"),s("h3",re,[a(e.$slots,"default")])]))));oe.render=ie,oe.__scopeId="data-v-8e6e9150";const le={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-book"},ce=s("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"},null,-1),ue=s("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"},null,-1);var pe=n({name:"Board",components:{BookIcon:function(e,t){return c(),o("svg",le,[ce,ue])},Button:Q,Headline:oe},setup:()=>({Library:ne()})});const de=r("data-v-67fc2823");i("data-v-67fc2823");const he={class:"library"},me=f(" Library "),ke=f("Summon");l();const fe=de(((e,t,n,a,r,i)=>{const l=h("BookIcon"),u=h("Headline"),p=h("Button");return c(),o("div",he,[s(u,null,{icon:de((()=>[s(l)])),default:de((()=>[me])),_:1}),(c(!0),o(m,null,k(e.Library.entries,(t=>(c(),o("ul",{key:t.slug},[s("li",null,[s("div",null,d(t.name),1),s("div",null,d(t.tokenOptions.power)+"P / "+d(t.tokenOptions.toughness)+"T",1),s(p,{onClick:n=>e.$emit("summon",t)},{default:de((()=>[ke])),_:2},1032,["onClick"])])])))),128))])}));function ge(e){return`var(--mana-color-${e}-background)`}function ve(e){return`var(--mana-color-${e}-text)`}pe.render=fe,pe.__scopeId="data-v-67fc2823";const ye={backgroundKey:"--mana-background",textKey:"--mana-text"};function we(t,n){const{backgroundKey:o,textKey:s}=e(e({},ye),n);return{[o]:ge(t),[s]:ve(t)}}const be=t({id:"popup",state:()=>({portalTarget:"#popup-portal",isOpen:!1}),actions:{open(){this.isOpen=!0},close(){this.isOpen=!1}}}),_e={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-x"},Se=s("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),Ce=s("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1);var xe=n({name:"App",components:{CloseIcon:function(e,t){return c(),o("svg",_e,[Se,Ce])}},setup(){const e=be();return g(e,(e=>{window.document.body.style.overflow=e.isOpen?"hidden":null})),{popupStore:e}}});const Te={key:0,class:"popup"},Ie=f("Close ");xe.render=function(e,t,n,r,i,l){const u=h("CloseIcon");return c(),o(v,{to:e.popupStore.portalTarget},[e.popupStore.isOpen?(c(),o("div",{key:0,class:"popup-underlay",onClick:t[1]||(t[1]=t=>e.popupStore.close())})):p("",!0),s(w,{name:"bounce"},{default:y((()=>[e.popupStore.isOpen?(c(),o("div",Te,[s("button",{onClick:t[2]||(t[2]=t=>e.popupStore.close())},[Ie,s(u)]),s("div",null,[a(e.$slots,"default")])])):p("",!0)])),_:1})],8,["to"])};const Le={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-plus"},Oe=s("line",{x1:"12",y1:"5",x2:"12",y2:"19"},null,-1),Ae=s("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1);const Be={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-minus"},je=s("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1);var Me=n({name:"LifePointsCounter",components:{Button:Q,PlusIcon:function(e,t){return c(),o("svg",Le,[Oe,Ae])},MinusIcon:function(e,t){return c(),o("svg",Be,[je])},Popup:xe},props:{player:Object},setup(e){const t={backgroundKey:"--mana-background",textKey:"--mana-text"},n=b((()=>we(e.player.mana,t))),o=b((()=>Object.values(x).map((n=>({mana:n,selected:e.player.mana===n,styles:we(n,t)})))));return{styles:n,popupStore:be(),manaCollection:o}}});const $e=r("data-v-5a583502");i("data-v-5a583502");const Ee=f("Reset Game");l();const Pe=$e(((e,t,n,a,r,i)=>{const l=h("PlusIcon"),u=h("MinusIcon"),p=h("Button"),f=h("Popup");return c(),o(m,null,[s("div",{class:"container",style:e.styles},[s("div",{class:"counter",onClick:t[1]||(t[1]=t=>e.popupStore.open())},d(e.player.life.remainingLife),1),s("button",{onClick:t[2]||(t[2]=t=>e.player.life.raise(1)),class:"button raise"},[s(l)]),s("button",{onClick:t[3]||(t[3]=t=>e.player.life.reduce(1)),class:"button reduce"},[s(u)])],4),s(f,null,{default:$e((()=>[(c(!0),o(m,null,k(e.manaCollection,(t=>(c(),o("button",{key:t.mana,class:["manaButton",t.selected&&"selected"],style:t.styles,onClick:n=>e.player.setManaType(t.mana)},null,14,["onClick"])))),128)),s("div",null,[s(p,{onClick:t[4]||(t[4]=t=>e.player.reset())},{default:$e((()=>[Ee])),_:1})])])),_:1})],64)}));Me.render=Pe,Me.__scopeId="data-v-5a583502";var De=n({name:"App",components:{Board:z,Button:Q,Library:pe,LifePointsCounter:Me},setup(){const t=j(),n=t.players[0];!function(t){t.$subscribe(((e,t)=>{window.localStorage.setItem("player1Store",JSON.stringify({board:t.board.$state,life:t.life.$state,mana:t.mana}))}));try{const n=window.localStorage.getItem("player1Store");if(n){const o=JSON.parse(n);t.$patch({board:e(e({},o.board),{token:o.board.token.map((t=>new L(e(e({},t._options),{hasSummoningSickness:t._summoningSickness,isTapped:t._tapped}))))}),life:o.life,mana:o.mana})}}catch(n){console.error(n)}}(n);const o=be();return{player1:n,appStore:t,popupStore:o,handleAttackAll:()=>n.board.attackWithAll(),handleNextTurn:()=>n.nextTurn(),handleSummon:t=>{const o=new L(e({},t.tokenOptions));n.board.addToken(o)}}}});const Re=f("Attack with all"),He=f("Next Turn");De.render=function(e,t,n,a,r,i){const l=h("LifePointsCounter"),u=h("Board"),p=h("Button"),d=h("Library");return c(),o("div",{class:["app-container",e.popupStore.isOpen&&"scale"]},[s(l,{player:e.player1},null,8,["player"]),s(u,{board:e.player1.board},null,8,["board"]),s(p,{onClick:e.handleAttackAll},{default:y((()=>[Re])),_:1},8,["onClick"]),s(p,{onClick:e.handleNextTurn},{default:y((()=>[He])),_:1},8,["onClick"]),s(d,{onSummon:e.handleSummon},null,8,["onSummon"])],2)};const Ne=_(De);Ne.use(S()),Ne.mount("#app");

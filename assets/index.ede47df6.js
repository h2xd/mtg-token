var e=Object.assign;import{d as t,a as n,c as s,b as o,r as a,o as i,e as r,f as c,w as l,t as d,g as u,F as p,h,p as m,i as k,j as f,k as g,l as b,m as v}from"./vendor.3db1e518.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const s=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,a)=>{const i=new URL(e,s);if(self[t].moduleMap[i])return n(self[t].moduleMap[i]);const r=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){a(new Error(`Failed to import: ${e}`)),o(c)},onload(){n(self[t].moduleMap[i]),o(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("https:/h2xd.github.io/mtg-token/assets/");const _=t({id:"life",state:()=>({remainingLife:20}),getters:{alive(){return this.remainingLife>0}},actions:{reset(){this.remainingLife=20},raise(e=1){this.remainingLife+=Math.abs(e)},reduce(e=1){this.remainingLife-=Math.abs(e),this.remainingLife<0&&(this.remainingLife=0)}}});var y,S;(S=y||(y={})).RED="red",S.BLUE="blue",S.GREEN="green",S.BLACK="black",S.WHITE="white";const w={power:1,toughness:1,isTapped:!1,hasSummoningSickness:!0,mana:[y.RED],attributes:[]};class L{constructor(t){this._summoningSickness=!0,this._options=e(e({},w),t),this._tapped=this._options.isTapped,this._summoningSickness=this._options.hasSummoningSickness,this.uuid=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))),this.reset()}get canAttack(){return!this._summoningSickness&&!this._tapped}get power(){return this._power}get toughness(){return this._toughness}get isTapped(){return this._tapped}get hasSummoningSickness(){return this._summoningSickness}attack(){this._summoningSickness||(this._tapped=!0)}clear(){this._summoningSickness=!1,this._tapped=!1}reset(){this._power=this._options.power,this._toughness=this._options.toughness}}const T=t({id:"board",state:()=>({token:[]}),getters:{hasToken(){return this.token.length>0},tokenThatCanAttack(){return this.token.filter((e=>e.canAttack))},attackPower(){return this.tokenThatCanAttack.reduce(((e,t)=>e+t.power),0)}},actions:{addToken(e){this.token=[...this.token,e]},removeToken(e){this.token=this.token.filter((t=>t!==e))},copyToken(e){this.token=[...this.token,new L({power:e.power,toughness:e.toughness})]},attackWithAll(){this.token.forEach((e=>e.attack()))},nextTurn(){this.token.forEach((e=>e.clear()))},reset(){this.token=[]}}}),I=t({id:"main",state:()=>({life:_(),board:T()}),getters:{alive(){return this.life.alive}},actions:{reset(){this.life.reset(),this.board.reset()},nextTurn(){this.board.nextTurn()}}});var C=n({props:{active:{type:Boolean,default:!1}}});const A={class:"container"},O={class:"base underlay"};C.render=function(e,t,n,r,c,l){return i(),s("div",A,[o("span",O,[a(e.$slots,"default")]),o("span",{class:["base","overlayed",e.active&&"active"]},[a(e.$slots,"default")],2)])};var x=n({name:"TokenCardDetail",components:{Icon:C,CornerDownLeftIcon:"https://h2xd.github.io/mtg-token/assets/corner-down-left.0b63fec4.svg",MoonIcon:"https://h2xd.github.io/mtg-token/assets/moon.1058d95e.svg"},props:{token:Object,is:{type:String,default:"li"}}});const B=l("data-v-7a632aa5"),$=B(((e,t,n,a,l,p)=>{const h=u("CornerDownLeftIcon"),m=u("Icon"),k=u("MoonIcon");return e.token?(i(),s(r(e.is),{key:0,class:["card",e.token.isTapped&&"tapped"]},{default:B((()=>[o("div",null,d(e.token.power)+" / "+d(e.token.toughness),1),o("div",null,[o(m,{active:e.token.isTapped},{default:B((()=>[o(h)])),_:1},8,["active"]),o(m,{active:e.token.hasSummoningSickness},{default:B((()=>[o(k)])),_:1},8,["active"])])])),_:1},8,["class"])):c("",!0)}));x.render=$,x.__scopeId="data-v-7a632aa5";var j=n({name:"Board",components:{TokenCardDetail:x},props:{board:Object},setup:e=>({handleDeath:t=>e.board.removeToken(t),handleCopy:t=>e.board.copyToken(t)})});const E=l("data-v-776e1f79");m("data-v-776e1f79");const M={key:0,class:"board"};k();const D=E(((e,t,n,a,r,l)=>{const m=u("TokenCardDetail");return i(),s(p,null,[o("div",null,"AttackPower: "+d(e.board.attackPower),1),o("div",null,[e.board.hasToken?(i(),s("ol",M,[(i(!0),s(p,null,h(e.board.token,(t=>(i(),s(m,{is:"li",key:t.uuid,token:t,onDeath:e.handleDeath,onCopy:e.handleCopy},null,8,["token","onDeath","onCopy"])))),128))])):c("",!0)])],64)}));j.render=D,j.__scopeId="data-v-776e1f79";const R={},P=l("data-v-5fb6ff72");m("data-v-5fb6ff72");const N={class:"button"};k();const U=P(((e,t)=>(i(),s("button",N,[a(e.$slots,"default")]))));var F;R.render=U,R.__scopeId="data-v-5fb6ff72",(F||(F={})).FLYING="flying";const H={name:"Angel",slug:"angel",isFavorite:!1,tokenOptions:e(e({},w),{power:4,toughness:4,mana:[y.WHITE],attributes:[F.FLYING]})},W={name:"Soldier",slug:"soldier",isFavorite:!1,tokenOptions:e(e({},w),{power:1,toughness:1,mana:[y.WHITE]})};var G=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AngelLibraryItem:H,SoldierLibraryItem:W});const J=t({id:"library",state:()=>({active:!1,entries:[...Object.values(G)]}),getters:{isActive(){return this.active}},actions:{setActive(){this.active=!0},setInactive(){this.active=!1},toggleActive(){this.active=!this.active}}});const Y={},z=l("data-v-8e6e9150");m("data-v-8e6e9150");const K={class:"headline"},V={class:"text"};k();const q=z(((e,t)=>(i(),s("div",K,[a(e.$slots,"icon"),o("h3",V,[a(e.$slots,"default")])]))));Y.render=q,Y.__scopeId="data-v-8e6e9150";var Q=n({name:"Board",components:{BookIcon:"https://h2xd.github.io/mtg-token/assets/book.167d9fc9.svg",Button:R,Headline:Y},setup:()=>({Library:J()})});const X=l("data-v-f6b1ecd8");m("data-v-f6b1ecd8");const Z=f(" Library "),ee=f("Summon");k();const te=X(((e,t,n,a,r,c)=>{const l=u("BookIcon"),m=u("Headline"),k=u("Button");return i(),s("div",{class:["library",e.Library.isActive&&"active"]},[o(m,null,{icon:X((()=>[o(l)])),default:X((()=>[Z])),_:1}),(i(!0),s(p,null,h(e.Library.entries,(t=>(i(),s("ul",{key:t.slug},[o("li",null,[o("div",null,d(t.name),1),o("div",null,d(t.tokenOptions.power)+"P / "+d(t.tokenOptions.toughness)+"T",1),o(k,{onClick:n=>e.$emit("summon",t)},{default:X((()=>[ee])),_:2},1032,["onClick"])])])))),128))],2)}));Q.render=te,Q.__scopeId="data-v-f6b1ecd8";var ne=n({name:"LifePointsCounter",components:{PlusIcon:"https://h2xd.github.io/mtg-token/assets/plus.bbdd3b2a.svg",MinusIcon:"https://h2xd.github.io/mtg-token/assets/minus.ff3bc845.svg"},props:{life:Object}});const se=l("data-v-ca6e6eca");m("data-v-ca6e6eca");const oe={class:"container"},ae={class:"counter"};k();const ie=se(((e,t,n,a,r,c)=>{const l=u("PlusIcon"),p=u("MinusIcon");return i(),s("div",oe,[o("div",ae,d(e.life.remainingLife),1),o("button",{onClick:t[1]||(t[1]=t=>e.life.raise(1)),class:"button raise"},[o(l)]),o("button",{onClick:t[2]||(t[2]=t=>e.life.reduce(1)),class:"button reduce"},[o(p)])])}));ne.render=ie,ne.__scopeId="data-v-ca6e6eca";var re=n({name:"App",components:{Board:j,Button:R,Library:Q,LifePointsCounter:ne},setup(){const t=I();!function(t){t.$subscribe(((e,t)=>{window.localStorage.setItem("player1Store",JSON.stringify({board:t.board.$state,life:t.life.$state}))}));try{const n=window.localStorage.getItem("player1Store");if(n){const s=JSON.parse(n);t.$patch({board:e(e({},s.board),{token:s.board.token.map((t=>new L(e(e({},t._options),{hasSummoningSickness:t._summoningSickness,isTapped:t._tapped}))))}),life:s.life})}}catch(n){console.error(n)}}(t);return{player1Store:t,handleAttackAll:()=>t.board.attackWithAll(),handleNextTurn:()=>t.nextTurn(),handleSummon:n=>{const s=new L(e({},n.tokenOptions));t.board.addToken(s)}}}});const ce=f("Reset"),le=f("Attack with all"),de=f("Next Turn");re.render=function(e,t,n,a,r,c){const l=u("LifePointsCounter"),d=u("Board"),h=u("Button"),m=u("Library");return i(),s(p,null,[o(l,{life:e.player1Store.life},null,8,["life"]),o(d,{board:e.player1Store.board},null,8,["board"]),o(h,{onClick:e.player1Store.reset},{default:g((()=>[ce])),_:1},8,["onClick"]),o(h,{onClick:e.handleAttackAll},{default:g((()=>[le])),_:1},8,["onClick"]),o(h,{onClick:e.handleNextTurn},{default:g((()=>[de])),_:1},8,["onClick"]),o(m,{onSummon:e.handleSummon},null,8,["onSummon"])],64)};const ue=b(re);ue.use(v()),ue.mount("#app");
